---
# Updated for Apple Silicon Macs - January 2025
# Uses pyenv for Python version management (more reliable than get-pip.py approach)

# =============================================================================
# PYTHON VERSION MANAGEMENT
# =============================================================================
- name: Install pyenv and dependencies
  community.general.homebrew:
    name:
      - pyenv                  # Python version manager
      - pyenv-virtualenv       # Virtual environment support for pyenv
      - openssl                # Required for building Python
      - readline               # Required for building Python
      - sqlite3                # Required for building Python
      - xz                     # Required for building Python
      - zlib                   # Required for building Python
    state: present
  when: ansible_os_family == 'Darwin'
  tags: python

# =============================================================================
# PIP CONFIGURATION
# =============================================================================
- name: Add pip directory
  file:
    name: ~/.pip
    state: directory
  tags: python

- name: Setup pip configuration
  copy:
    dest: ~/.pip/pip.conf
    src: pip.conf
  tags: python

# =============================================================================
# PYENV SHELL INTEGRATION
# Note: pyenv initialization is handled in zshrc
# =============================================================================
